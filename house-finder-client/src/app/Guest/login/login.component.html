<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />

<!-- Login page -->
<ng-container class="col-md-6 offset-md-3 mt-5 text-center" #loginTemplate *ngIf="login; else registerTemplate">
  <div class="row d-flex justify-content-center vh-100">
    <!-- Images Column -->
    <div class="col-6 pt-4" id="logo">
      <div style="flex-direction: column">
        <div>
          <!-- FPT University logo -->
          <img id="FPTULogo" />
        </div>
        <!-- FU House Finder logo -->
        <div>
          <a href="" (click)="backHome()">
            <img id="FUHouseFinderLogo" class="top-50 start-50" src="../../../assets/image/Logo.png"/>
          </a>
        </div>
        <!-- Website's name -->
        <div class="orangeText">
          <h1>FU HOUSE FINDER</h1>
          <h5>Ứng dụng tìm trọ dành cho sinh viên Đại học FPT</h5>
        </div>
      </div>
    </div>

    <!-- Content Column -->
    <div class="col-lg-6 col-sm-12 h-100 d-flex justify-content-center align-items-center loginCol">
      <a href="" (click)="backHome()">
        <span class="material-symbols-outlined" id="backHomeButton">
          arrow_back
        </span>
      </a>
      <div class="row">
        <h3 class="whiteText titleLogin">ĐĂNG NHẬP</h3>
        <!-- Sign in with Facebook -->
        <div class="row d-flex justify-content-center my-2 mx-1">
          <div class="fb-login-button col-auto" data-width="320" data-size="large" data-button-type="continue_with"
            data-layout="rounded"></div>
        </div>

        <!-- Sign in with Google -->
        <div class="row d-flex justify-content-center my-2 mx-1">
          <div clasd="col-auto" style="width: fit-content" #ggDiv></div>
        </div>

        <!-- Orther methods of log in/sign up -->
        <span>hoặc sử dụng</span>

        <!-- Sign in with email and password -->
        <div class="row mx-1">
          <form class="col" [formGroup]="loginForm" (ngSubmit)="loginUsernamePassword()">
            <div class="formCover rounded-4">
              <div class="row d-flex justify-content-center mt-4">
                <mat-form-field appearance="legacy" class="loginInput">
                  <mat-label>Email</mat-label>
                  <input matInput type="text" formControlName="username" class="loginInputField" required />
                </mat-form-field>
              </div>
              <div class="row d-flex justify-content-center">
                <mat-form-field appearance="legacy" class="loginInput">
                  <mat-label>Mật khẩu</mat-label>
                  <input matInput type="password" formControlName="password" class="loginInputField" required />
                </mat-form-field>
              </div>
              <!-- Log in button -->
              <div class="row d-flex justify-content-center m-2">
                <button class="form-control rounded-pill whiteButton" type="submit">
                  Đăng nhập
                </button>
              </div>
            </div>
          </form>
        </div>

      </div>
    </div>
  </div>
</ng-container>
<!-- End login page -->

<!-- Landlord register -->
<ng-template #registerTemplate>
  <app-header></app-header>
  <div class="register">
    <!-- Step 1: Phone number and Facebook link -->
    <mat-stepper [linear]="true" #stepper>
      <mat-step label="Điền Thông tin liên hệ" [stepControl]="contactForm">
        <form [formGroup]="contactForm">
          <div class="row d-flex justify-content-center">
            <div class="col-auto step1">
              <!-- Phone number -->
              <div class="row">
                <mat-form-field appearance="fill" color="white" style="width: 400px" class="m-0 p-0">
                  <mat-label>Số điện thoại</mat-label>
                  <input matInput type="tel" id="phonenumber" formControlName="phonenumber" required />
                </mat-form-field>
              </div>
              <!-- Link Facebook -->
              <div class="row">
                <mat-form-field appearance="fill" style="width: 400px" class="m-0 p-0">
                  <mat-label>Link Facebook</mat-label>
                  <input matInput type="url" id="facebookUrl" formControlName="facebookUrl" required />
                </mat-form-field>
              </div>
              <div class="row d-flex justify-content-end">
                <button mat-raised-button class="orangeButton" matStepperNext>
                  Tiếp theo
                </button>
              </div>
            </div>
          </div>
        </form>
      </mat-step>

      <!-- Step 2: Upload identity card -->
      <mat-step label="Chụp ảnh CMND" [stepControl]="imageForm">
        <form [formGroup]="imageForm">
          <div class="row d-flex justify-content-center">
            <div class="col-auto mt-4 step2">
              <div class="row d-flex justify-content-around">
                <!-- Identity card (front side) -->
                <div class="col-auto p-0 identityCard">
                  <div class="dragAndDropArea d-flex">
                    <!-- Identity card image -->
                    <img [src]="frontImgSrc" class="p-1" />
                    <span class="col align-self-center">Kéo thả ảnh ở đây</span>
                    <!-- Folder image -->
                    <div>
                      <svg width="64" height="64" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg"
                        xmlns:xlink="http://www.w3.org/1999/xlink">
                        <rect width="64" height="64" fill="url(#pattern0)" />
                        <defs>
                          <pattern id="pattern0" patternContentUnits="objectBoundingBox" width="1" height="1">
                            <use xlink:href="#image0_211_16" transform="scale(0.015625)" />
                          </pattern>
                          <image id="image0_211_16" width="64" height="64"
                            xlink:href="data:image/png;base64,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" />
                        </defs>
                      </svg>
                    </div>
                    <input type="file" id="frontImg" accept="image/*" style="height: 100%;
                      width: 100%;
                      opacity: 0;
                      position: absolute;
                      z-index: 10;
                      margin: 0px;" (change)="displayImage($event, 'front')"
                      formControlName="identityCardFrontSideImageLink" required />
                  </div>
                  <div class="row d-flex justify-content-center mt-2">
                    <div class="col-auto" style="width: fit-content">
                      CCCD mặt trước
                    </div>
                  </div>
                </div>
                <!-- End front side -->

                <!-- Identity card (back side) -->
                <div class="col-auto p-0 identityCard">
                  <div class="dragAndDropArea d-flex">
                    <img [src]="backImgSrc" class="p-1" />
                    <span class="col align-self-center">Kéo thả ảnh ở đây</span>
                    <div>
                      <svg width="64" height="64" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg"
                        xmlns:xlink="http://www.w3.org/1999/xlink">
                        <rect width="64" height="64" fill="url(#pattern0)" />
                        <defs>
                          <pattern id="pattern0" patternContentUnits="objectBoundingBox" width="1" height="1">
                            <use xlink:href="#image0_211_16" transform="scale(0.015625)" />
                          </pattern>
                          <image id="image0_211_16" width="64" height="64"
                            xlink:href="data:image/png;base64,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" />
                        </defs>
                      </svg>
                    </div>
                    <input type="file" id="backImg" accept="image/*" style="height: 100%;
                      width: 100%;
                      opacity: 0;
                      position: absolute;
                      z-index: 10;
                      margin: 0px;" (change)="displayImage($event, 'back')"
                      formControlName="identityCardBackSideImageLink" required />
                  </div>
                  <div class="row d-flex justify-content-center mt-2">
                    <div class="col-auto" style="width: fit-content">
                      CCCD mặt sau
                    </div>
                  </div>
                </div>
                <!-- End back side -->
              </div>
              <div class="row d-flex justify-content-between mt-5">
                <button mat-raised-button matStepperPrevious class="blueButton"> Quay lại </button>
                <button mat-raised-button matStepperNext class="orangeButton"> Tiếp theo </button>
              </div>
            </div>
          </div>
        </form>
      </mat-step>

      <!-- Step 3: Confirm information -->
      <mat-step label="Xác nhận thông tin">
        <div class="container step3">
          <b class="d-flex justify-content-center">Xác nhận thông tin đăng ký</b>
          <div class="d-flex justify-content-center">
            <div class="row mx-3">
              <!-- Phone number and Facebook -->
              <table>
                <tr>
                  <td class="align-top"><b>Số điện thoại:</b></td>
                  <td>{{ contactForm.controls["phonenumber"].value }}</td>
                </tr>
                <tr>
                  <td class="align-top"><b>Facebook:</b></td>
                  <td>
                    <a style="word-break: break-all;" href="{{ contactForm.controls['facebookUrl'].value }}">{{
                      contactForm.controls["facebookUrl"].value }}</a>
                  </td>
                </tr>
              </table>
              <!-- Identity card -->
              <table>
                <tr>
                  <td><b>CMND mặt trước</b></td>
                  <td><b>CMND mặt sau</b></td>
                </tr>
                <tr>
                  <td class="me-2 align-top">
                    <img class="viewIdentityCard" [src]="frontImgSrc" />
                  </td>
                  <td class="align-top">
                    <img class="viewIdentityCard" [src]="backImgSrc" />
                  </td>
                </tr>
              </table>
            </div>
          </div>

          <div class="row d-flex justify-content-around my-5 h-75">
            <button mat-raised-button matStepperPrevious class="blueButton">
              Quay lại
            </button>
            <button mat-raised-button class="orangeButton" (click)="onSubmit()">
              Đăng kí
            </button>
          </div>
        </div>
      </mat-step>
    </mat-stepper>
  </div>
  <app-footer></app-footer>
</ng-template>

<!-- Alerts by Template: sweetalert2 -->
<swal #landLordAccountLockedAlert title="Khóa tài khoản"
  text="Tài khoản của bạn đã bị khóa do vi phạm điều khoản của chúng tôi. Vui lòng trình diện tại cơ sở Đại học FPT gần nhất để làm thủ tục mở khóa tài khoản"
  icon="error" [focusCancel]="true">
</swal>
<swal #landLordAccountConfirmAlert title="Xác nhận tài khoản"
  text="Tài khoản của bạn chưa được phép đăng ký thông tin nhà trọ. Vui lòng đến cơ sở Đại học FPT gần nhất để làm thủ tục xác nhận tài khoản"
  icon="warning" [focusCancel]="true" (confirm)="navigate('/Landlord/dashboard')">
</swal>
<swal #invalidEmailPasswordAlert title="Đăng nhập không hợp lệ" text="Email hoặc Password không hợp lệ" icon="error"
  [focusCancel]="true">
</swal>
<swal #serverErrorAlert [toast]="true" position="top-end" [timer]="3000" [timerProgressBar]="true" title="Lỗi Server"
  icon="error">
</swal>
<swal #landlordAccountCreatedAlert title="Đăng ký thành công"
  text="Bạn đã đăng ký thành công! Vui lòng đến cơ sở Đại học FPT gần nhất để làm thủ tục xác nhận tài khoản."
  icon="success" [focusCancel]="true" (confirm)="navigate('/Landlord/dashboard')">
</swal>
